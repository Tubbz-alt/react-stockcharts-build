{"version":3,"sources":["../../../src/lib/coordinates/CrossHairCursor.js"],"names":["CrossHairCursor","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","dotRadius","dotFill","dotStroke","dotStrokeWidth","lines","helper","context","margin","ratio","originX","left","originY","top","save","setTransform","scale","translate","forEach","dashArray","line","strokeDasharray","split","map","d","lineWidth","strokeWidth","strokeStyle","stroke","opacity","setLineDash","beginPath","moveTo","x1","y1","lineTo","x2","y2","arc","Math","PI","fillStyle","fill","restore","className","idx","rest","propTypes","string","oneOf","yAccessor","func","contextTypes","object","isRequired","number","customX","xScale","xAccessor","currentItem","mouseXY","snapX","x","round","customY","yScale","chartConfig","snapY","y","defaultProps","strokeX","strokeY","strokeWidthX","strokeWidthY","show","height","width","line1","line2"],"mappings":"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","file":"CrossHairCursor.js","sourcesContent":["\"use strict\";\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport GenericComponent, { getMouseCanvas } from \"../GenericComponent\";\n\nimport { hexToRGBA, isDefined, isNotDefined, strokeDashTypes, getStrokeDasharray } from \"../utils\";\n\nclass CrossHairCursor extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { dotRadius, dotFill, dotStroke, dotStrokeWidth } = this.props;\n\t\tconst lines = helper(this.props, moreProps);\n\t\tif (isDefined(lines)) {\n\n\t\t\tconst { margin, ratio } = this.context;\n\t\t\tconst originX = 0.5 * ratio + margin.left;\n\t\t\tconst originY = 0.5 * ratio + margin.top;\n\n\t\t\tctx.save();\n\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\t\t\tctx.scale(ratio, ratio);\n\n\t\t\tctx.translate(originX, originY);\n\n\t\t\tlines.forEach(line => {\n\t\t\t\tconst dashArray = getStrokeDasharray(line.strokeDasharray).split(\",\").map(d => +d);\n\n\t\t\t\tctx.lineWidth = line.strokeWidth;\n\t\t\t\tctx.strokeStyle = hexToRGBA(line.stroke, line.opacity);\n\t\t\t\tctx.setLineDash(dashArray);\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo(line.x1, line.y1);\n\t\t\t\tctx.lineTo(line.x2, line.y2);\n\t\t\t\tctx.stroke();\n\t\t\t});\n\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(lines[1].x1, lines[0].y1, dotRadius, 0, 2 * Math.PI, false);\n\t\t\tctx.fillStyle =  hexToRGBA(dotFill, 1);\n\t\t\tctx.fill();\n\t\t\tctx.lineWidth = dotStrokeWidth;\n\t\t\tctx.strokeStyle = hexToRGBA(dotStroke, 1);\n\t\t\tctx.stroke();\n\t\t\tctx.restore();\n\t\t}\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { className } = this.props;\n\t\tconst lines = helper(this.props, moreProps);\n\n\t\tif (isNotDefined(lines)) return null;\n\n\t\treturn (\n\t\t\t<g className={`react-stockcharts-crosshair ${className}`}>\n\t\t\t\t{lines.map(({ strokeDasharray, ...rest }, idx) =>\n\t\t\t\t\t<line\n\t\t\t\t\t\tkey={idx}\n\t\t\t\t\t\tstrokeDasharray={getStrokeDasharray(strokeDasharray)}\n\t\t\t\t\t\t{...rest} />)}\n\t\t\t</g>\n\t\t);\n\t}\n\trender() {\n\t\treturn <GenericComponent\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tclip={false}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\tdrawOn={[\"mousemove\", \"pan\", \"drag\"]}\n\t\t/>;\n\t}\n}\n\nCrossHairCursor.propTypes = {\n\tclassName: PropTypes.string,\n\tstrokeDasharray: PropTypes.oneOf(strokeDashTypes),\n\tyAccessor: PropTypes.func\n};\n\nCrossHairCursor.contextTypes = {\n\tmargin: PropTypes.object.isRequired,\n\tratio: PropTypes.number.isRequired,\n\t// xScale for getting update event upon pan end, this is needed to get past the PureComponent shouldComponentUpdate\n\t// xScale: PropTypes.func.isRequired,\n};\n\nfunction customX(props, moreProps) {\n\tconst { xScale, xAccessor, currentItem, mouseXY } = moreProps;\n\tconst { snapX } = props;\n\tconst x = snapX\n\t\t? Math.round(xScale(xAccessor(currentItem)))\n\t\t: mouseXY[0];\n\treturn x;\n}\n\nfunction customY(props, moreProps) {\n\tconst { chartConfig: { yScale }, currentItem, mouseXY } = moreProps;\n\tconst { snapY, yAccessor } = props;\n\tconst y = snapY\n\t\t? Math.round(yScale(yAccessor(currentItem)))\n\t\t: mouseXY[1];\n\treturn y;\n}\n\n\nCrossHairCursor.defaultProps = {\n\tstrokeX: \"#666666\",\n\tstrokeY: \"#666666\",\n\tstrokeWidthX: 1,\n\tstrokeWidthY: 1,\n\tdotFill: \"#666666\",\n\tdotRadius: 0.0,\n\tdotStroke: \"#666666\",\n\tdotStrokeWidth: 0.0,\n\topacity: 0.3,\n\tstrokeDasharray: \"ShortDash\",\n\tsnapX: true,\n\tsnapY: false,\n\tcustomX,\n\tcustomY\n};\n\nfunction helper(props, moreProps) {\n\tconst {\n\t\tcurrentItem, show, height, width\n\t} = moreProps;\n\n\tconst { customX, customY, strokeX, strokeY, strokeWidthX, strokeWidthY,\n\t\topacity, strokeDasharray } = props;\n\n\tif (!show || isNotDefined(currentItem)) return null;\n\n\tconst x = customX(props, moreProps);\n\tconst y = customY(props, moreProps);\n\n\tconst line1 = {\n\t\tx1: 0,\n\t\tx2: width,\n\t\ty1: y,\n\t\ty2: y,\n\t\tstroke: strokeY,\n\t\tstrokeWidth: strokeWidthY,\n\t\tstrokeDasharray, opacity,\n\t};\n\n\tconst line2 = {\n\t\tx1: x,\n\t\tx2: x,\n\t\ty1: 0,\n\t\ty2: height,\n\t\tstroke: strokeX,\n\t\tstrokeWidth: strokeWidthX,\n\t\tstrokeDasharray, opacity,\n\t};\n\treturn [line1, line2];\n}\n\nexport default CrossHairCursor;\n"]}